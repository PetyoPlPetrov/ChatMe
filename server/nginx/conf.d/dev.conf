# Development Environment Configuration
# More permissive settings optimized for local development

# Development upstream definitions
upstream auth_service {
    server chatme-auth-dev:5001;
    # Fallback for direct service access during development
    server 127.0.0.1:5001 backup;
}

upstream core_service {
    server chatme-core-dev:5000;
    # Fallback for direct service access during development
    server 127.0.0.1:5000 backup;
}

# Development rate limiting (more permissive)
limit_req_zone $binary_remote_addr zone=api:10m rate=100r/s;
limit_req_zone $binary_remote_addr zone=auth:10m rate=50r/s;

# Map for development environment
map $request_uri $environment {
    default "development";
}

# Development logging (more verbose)
log_format dev_format '$remote_addr - $remote_user [$time_local] '
                      '"$request" $status $body_bytes_sent '
                      '"$http_referer" "$http_user_agent" '
                      'rt=$request_time uct="$upstream_connect_time" '
                      'uht="$upstream_header_time" urt="$upstream_response_time" '
                      'auth_user="$upstream_http_x_user_email"';

access_log /var/log/nginx/access.log dev_format;